/*
 Ajax Search v1.0.4 | @nivocart | NivoCart | GNU GPL3 Licensed
*/
function doLiveSearch(e,d){return 38==e.keyCode||40==e.keyCode?!1:($("#livesearch").remove(),updown=-1,""==d||d.length<2?!1:(d=encodeURIComponent(d),$.ajax({url:$("base").attr("href")+"index.php?route=product/search/livesearch&keyword="+d,dataType:"json",content:this,success:function(e){if(e.length>0){var d,n,t,o=document.createElement("ul");o.id="livesearch";for(var i in e)d=document.createElement("li"),t=document.createElement("a"),n=document.createElement("img"),n.setAttribute("src",e[i].image),n.setAttribute("alt",e[i].alt),$(n).load(function(){$(this).show()}),t.appendChild(n),t.appendChild(document.createTextNode(e[i].name)),t.href="undefined"!=typeof e[i].href?e[i].href:$("#hidden").attr("href")+"index.php?route=product/product&product_id="+e[i].product_id,d.appendChild(t),o.appendChild(d);$("#livesearch").length>0&&$("#livesearch").remove(),$("#search").append(o)}}}),!0))}function upDownEvent(e){var d=document.getElementById("livesearch");if(d){var n=d.childNodes.length-1;if(-1!=updown&&"undefined"!=typeof d.childNodes[updown]&&$(d.childNodes[updown]).removeClass("highlighted"),38==e.keyCode?updown=updown>0?--updown:updown:40==e.keyCode&&(updown=n>updown?++updown:updown),updown>=0&&n>=updown){$(d.childNodes[updown]).addClass("highlighted");var t=d.childNodes[updown].childNodes[0].text;"undefined"==typeof t&&(t=d.childNodes[updown].childNodes[0].innerText),$("#search").find("[name='search']").first().val(new String(t).replace(/(\s\(.*?\))$/,""))}}return!1}var updown=-1;$(document).ready(function(){$("#search").find("[name='search']").first().keyup(function(e){doLiveSearch(e,this.value)}).focus(function(e){doLiveSearch(e,this.value)}).keydown(function(e){upDownEvent(e)}).blur(function(){window.setTimeout("$('#livesearch').hide(); updown=0;",400)}),$(document).on("keydown",function(e){try{13==e.keyCode&&$(".highlighted").length>0&&(document.location.href=$(".highlighted").find("a").first().attr("href"))}catch(d){}})});
